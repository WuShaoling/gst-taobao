# Process of build docker image

## 1. build hadoop:base image
```
# cd hadoop1-base
# docker build -t hadoop:base .
# docker run -d hadoop:base
```

Enter the container

```
# docker exec -it {your-container-id} /bin/bash
```

intall java8, mysql, openssh-server

```
// install oracle jdk8
# sudo apt-get update
# sudo apt-get install -y software-properties-common
# sudo add-apt-repository ppa:webupd8team/java -y
# sudo apt-get update
# sudo apt-get install -y oracle-java8-installer

// install mysql, set root password 123456, set charset utf-8
# sudo apt-get install -y mysql-server
# vim /etc/mysql/my.cnf
//set  "character_set_server=utf8"
# chown -R mysql:mysql /var/lib/mysql /var/run/mysqld
# mysql -u root -p //add hive db
mysql> create database hive;
mysql> grant all on *.* to hive@localhost identified by 'hive';
mysql> alter database hive character set latin1;
mysql> flush privileges;
mysql> exit

// install openssh-server
# sudo apt-get install -y openssh-server
# vim /etc/ssh/sshd_config
set PermitRootLogin yes
// permit login without password
# ssh-keygen -t rsa
# cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
```

## 2. build hadoop:test images

```
# cd hadoop2-hadoop
# docker build -t hadoop:hadoop .
```
在HDFS中配置hive的存取目录
```
# $HADOOP_HOME/bin/hadoop fs -mkdir /tmp
# $HADOOP_HOME/bin/hadoop fs -mkdir /user
# $HADOOP_HOME/bin/hadoop fs -mkdir /user/hive
# $HADOOP_HOME/bin/hadoop fs -mkdir /user/hive/warehouse
# $HADOOP_HOME/bin/hadoop fs -chmod g+w /tmp
# $HADOOP_HOME/bin/hadoop fs -chmod g+w /user/hive/warehouse
```


## 3. test hadoop:test image
After test, you can retag hadoop:test to hadoop:release
